The quick   brown  fox  jumps  over   the   lazy  dog 」 と い う 文 なら たとえば 「 Tqbfjotld 」 と い う パスワード に でき ま す 。
モデル の インスタンス で は 、 配列 また は ハッシュ のみ が 使用 でき ま す 。
[ Symantec  Global   Internet   Security   threat   report ] ( http://eval ▖symantec▖ com/mktginfo/enterprise/white_papers/b -whitepaper_ internet_security_ threat _ report_xiii_ 04 - 2008 ▖ en -us ▖ pdf )   に は 、 2007 年 後半 に ブラウザ の プラグ イン で 239 の 脆弱 性 が 報告 さ れ て い ま す 。
* * CSRF : **  クロス サイト リクエストフォージェリ   ( Cross - Site   Request   Forgery )   は クロス サイト リファレンス フォージェリ   ( XSRF :   Cross - Site   Reference   Forgery )   と も 呼 ば れ 、 非常 に 強力 な 攻撃 手法 で す ▟ この 攻撃 を 受け る と 、 管理 者 や イントラネット ユーザー が 行え る こと を すべて 行え る よう に な っ て しま い ま す 。
Web アプリケーション に は 、 何 ら か の 形 で アクセス 制御 が 行 わ れ る の が 普通 で す 。
上 の コード は 検索 用 の アクション など で 使 わ れ る もの で あ り 、 ユーザー は 検索 し た い プロジェクト 名 を 入力 し ま す 。
検証 に 失敗 する と Verify _ recaptcha から false が 返 さ れ ま す 。
既存 の レコード と マッチ する 場合 、 アプリケーション は アクセス を 許可 し ま す 。
この メール に は 、 「 お 客 様 の ため の e - カード が ござ い ま す 」 と 書 か れ て お り 、 image タグ が 含 ま れ て い ま し た ▟ そして その タグ に は 、 ユーザー の ルーター を 再 構成 し て しま う HTTP   GET リクエスト が 仕込 ま れ て い ま し た ▟ この ルーター は 、 メキシコ で 広 く 普及 し て い る モデル で す 。
この ユーザー が URL の id を 42 に 変更 し 、 本来 の id で は 表示 でき な い ページ を 表示 でき て しま い ま す 。
*   フィールド を 見 な い ぐらい に 小さ く し たり 、 背景 と 同じ 色 に し たり する
*   管理 者 は 、 必ず しも その Web アプリケーション 全体 に アクセス でき る 必要 は な い はず で す 。
Rails に は 、 この よう な 攻撃 を かわ す ため の ヘルパー メソッド が 用意 さ れ て い ま す 。
詳細 に つ い て は 、 下記 を 参照 し て くださ い 。
プロキシ を 使用 し て 送信 元 IP アドレス を 偽 る 方法 が あ る こと も 念頭 に お い て くださ い 。
悪事 に 使 わ れ る メール アドレス 、 非 公式 の アクション 、 邪悪 な HTML タグ など に つ い て ブラック リスト が 作成 さ れ る こと が あ り ま す 。
Google   Adsense の メール アドレス と パスワード が 変更 さ れ た 事例 も あ り ま す 。
###  ホワイト リスト と ブラック リスト
他 に も 、 データ を 操作 し たり 任意 の データ を 読み出 し たり する 目的 に も 使用 さ れ ま す 。
_ 極めて 重要 な 操作 で は 特殊 な パスワード を 要求 する _   よう に する と い う 方法 も あ り ま す 。
2007 年 、 その 名 も Monster▖ com と い う オン ライン リクルート 用 Web アプリケーション で 、 特別 に 作 ら れ た トロイ の 木馬 プログラム に よ っ て イントラネット から 情報 が 盗み出 さ れ 、 文字 どおり 経営 者 に と っ て の モンスター と な っ た 事件 が あ り ま し た 。
SELECT  *  FROM   users   WHERE   login   =  ''  OR   ' 1 ' = ' 1 '   AND   password   = ''  OR   ' 2 ' > ' 1 '   LIMIT   1
この 方法 は 、 フォーマット バリ データ 使用 時 に 起き がち な 間違い から 保護 する ため だけ の もの で す ▟ 「 \^ 」 と 「 $ 」 は Ruby で は   * * 1 つ の 行 * *   に 対 し て マッチ し 、 文字 列 全体 に マッチ し な い と い う こと を よく 理解 する こと が 重要 で す 。
  _ 送信 元 IP アドレス を 一定 の 範囲 に 制限 する _  と い う 方法 を 考え て み ま しょ う 。
config ▖filter_ parameters <<  : password
raise  if  basename   !
多く の XSS の 例 で は 、 単に 警告 ボックス を 表示 する だけ で す が 、 実際 の XSS 攻撃 は もっと 凶悪 で す 。
send _file  filename ,   disposition :  'inline '
人気 の 高 い [ devise ] (https://github▖ com/plataformatec/devise )   や [ authlogic ] (https://github▖ com/binarylogic/authlogic ) など の 優れ た プラグ イン は 、 パスワード を 平文 で は な く 常 に 暗号 化 し た 状態 で 保存 し ま す 。
クエリ の ユーザー 入力 データ を その まま 使用 せ ず に 改ざん する 方法 の 例 を 以下 で 説明 し ま す 。
その ため 、 projects テーブル から すべて の レコード が 取り出 さ れ ま す ▟ これ ら は 通常 の ユーザー から は 参照 でき な い はず の もの で す 。
攻撃 点   ( entry   point )   と は 、 攻撃 者 が 攻撃 を 向け る 対象 と な る 、 脆弱 な URL および パラメータ の こと で す 。
しかし SQL インジェクション は ひとたび 発生 すれ ば 壊滅 的 な 打撃 を 受け る 可能 性 が あ り 、 Web アプリケーション に 対 する 一般 的 な 攻撃 方法 で も あ る ため 、 この 問題 を 十分 に 理解 する こと が 重要 で す 。
XSS 攻撃 は 次 の よう に 行 わ れ ま す ▟ 攻撃 者 が 何 ら か の コード を Web アプリケーション に 注入 し 、 後 に 標的 ユーザー の Web ページ 上 に 表示 さ れ ま す 。
ハッシュ を 渡 し て 同じ 結果 を 得 る こと も でき ま す 。
NOTE : _ ユーザー が どんな ファイル で も ダウンロード でき る 状態 に し な い で くださ い
イントラネット および 管理 画面 インターフェイス に は 、 他 より も 手厚 い セキュリティ 対策 が 必要 で す が 、 現実 に は 逆 に むしろ これ ら の 方 が セキュリティ 対策 が 薄 い と い う こと が しばしば あ り ま す 。
ただし 最初 の 節 で は 、 インジェクション の 際 の 接続 方法 に お け る アーキテクチャ 上 の 決定 事項 に つ い て 説明 し ま す 。
いわゆる スパム ボット 以外 に 、 自動 ログ イン ボット も 問題 と な り ま す 。
ブラウザ に は 同一 生成 元 ポリシー が あ る の で 、 w w w ▖application▖ com   に 注入 さ れ た XSS スクリプト から は   admin ▖ application▖ com   の cookie は 読み 出せ ず 、 逆 に つ い て も 同様 に 読み出し 不可 と な り ま す 。
send _file ( ) メソッド は 、 サーバー から クライアント に ファイル を 送信 し ま す 。
攻撃 者 は 、 あ り そう な ID と パスワード の 組み合わせ を 総当り で 試 す 危険 な Image タグ を 送り込 む だけ で 、 数千 も の まぐれ 当たり を 得 る こと も あ り ま す 。
想定 さ れ る 攻撃 と し て は 、 管理 者 の cookie の 盗み出 し 、 管理 者 パスワード を 盗み出 す ため の iframe 注入 、 管理 者 権限 奪取 の ため に ブラウザ の セキュリティ ホール を 経由 し て 邪悪 な ソフトウェア を インストール する 、 など が 考え られ ま す 。
SELECT  *  FROM   users   WHERE   ( users ▖ activation_code   IS   NULL )   LIMIT   1
この 方法 は 攻撃 に 対 する 直接 の 防弾 に は な り ま せ ん が 、 検問 と し て 非常 に 有効 で す 。
####   その 他
###   その 他 の 予防 策
管理 画面 に  _ ロール   ( role) _  を 導入 する こと で 、 攻撃 者 が 行え る 操作 の 範囲 を 狭め る こと が でき ま す ▟ 1人 の 管理 者 に 全権 を 与え る の で は な く 、 権限 を 複数 管理 者 で 分散 する の で す 。
####   はじめ に
Web アプリケーション に よ っ て は この コード で も 問題 は あ り ま せ ん が 、 その ユーザー が すべて の ビュー を 参照 する 権限 が な い 場合 に は 問題 と な り ま す 。
NOTE : _ アカウント に 対 する 総当たり 攻撃   ( Brute - force   attack )   と は 、 ログ イン 情報 に 対 し て 試行 錯誤 を 繰り返 す 攻撃 で す 。
ただし 、 イントラネット や 管理 アプリケーション に と っ て 最も 脅威 な の は XSS と CSRF で す 。
 _SafeErb プラグ イン _  を イントラネット や 管理 画面 で も 使用 する こと を 強 く お 勧め し ま す 。
一方 、 攻撃 者 に と っ て 気がかり な の は 、 両方 の クエリ で カラム の 数 を 同じ に し な けれ ば な ら な い と い う こと で す 。
SELECT  *  FROM   projects   WHERE   ( name  =  '')   UNION
####  認証 の バイパス
')   UNION   SELECT   id , login   AS   name , password   AS   description , 1 , 1 , 1   FROM   users  --
言 う まで も な く 、 この 攻撃 を 成功 さ せ る ため に は 攻撃 者 が URL 構造 を 知 っ て い る 必要 が あ り ま す が 、 Rails の URL は かなり 構造 が 素直 で あ る ため 、 オープン ソース の 管理 画面 を 使用 し て い る と 構造 を 容易 に 推測 でき て しま い ま す 。
パラメータ が nil の 場合 、 以下 の SQL が 生成 さ れ ま す 。
この 手法 は 、 迷惑 な ユーザー へ の 対応 策 と し て も 有効 で す 。
ただし 、 常 に 最新 の 状態 に アップデート する よう に し て くださ い 。
```sql
多く の 場合 、 CSRF と XSS が 原因 と な り ま す 。
この フィールド を サーバー 側 で チェック し ま す ▟ フィールド に 何 か 書き込 ま れ て い れ ば 、 入力 者 は ボット で あ る と 判定 でき ま す 。
  /\Ahttps?:\/\/[^\n ] + \z /i
この ため 、 多く の Ruby 本 や Rails 本 で も この 点 に 誤り が 生 じ て い ま す 。
たとえば 、 URL 形式 に な っ て い る か どう か を ざっくり と 検証 し た い の で 、 以下 の よう な 単純 な 正規 表現 を 使用 し た と し ま す 。
以下 の 節 で は 、 インジェクション 攻撃 が 発生 し う る 重要 な コンテキスト に つ い て 説明 し ま す 。
####   攻撃 点
これ ら の 正規 表現 は 、 危険 な 「 \^ 」 や 「 $ 」 を 安全 な 「 \ A 」 や 「 \ z 」 に 置き換え る 必要 が あ り ま す 。
この 攻撃 用 文字 列 で は 、 その ため に 2 番 目 の クエリ に 「 1 」 を 連続 し て 配置 し て い ま す ▟ これ ら の 値 は 常 に 1 に な る の で 、 1 番 目 の クエリ の カラム 数 と 一致 し ま す 。
*   ハニー ポット フィールド を 隠 さ ず 、 その 代わり 「 この フィールド に は 何 も 入力 し な い で くださ い 」 と 表示 する
*   フィールド 名 を ランダム に 変更 し ま す
    *  ブラック リスト に 引っかか っ た 入力 は 受け付け な い で くださ い 。
ここ で 、 悪意 の あ る ユーザー が 「 '  OR   1   - - 」 と い う 文字 列 を 入力 する と 、 以下 の SQL クエリ が 生成 さ れ ま す 。
コメント 入力 欄 など で 、 歪 ん だ 画像 に 表示 さ れ て い る 文字 を 入力 さ せ る こと で 、 入力 社 が 自動 スパム ボット で な い こと を 確認 する 場合 に よく 使用 さ れ ま す 。
表示 さ れ る リンク は 一見 無害 に 見え ま す が 、 クリック する と 、 攻撃 者 が 送り込 ん だ 邪悪 な Java Script 関数 を 初め と する Java Script コード が 実行 さ れ て しま い ま す 。
CAPTCHA の API と し て は [ re CAPTCHA ] ( http://recaptcha ▖ net/ ) が 有名 で す ▟ これ は 古書 から 引用 し た 言葉 を 歪 ん だ 画像 と し て 表示 し ま す 。
http://hi▖ com
この API から は 公開 鍵 と 秘密 鍵 の 2 つ の 鍵 を 受け取 り ま す ▟ これ ら は Rails の 環境 に 置 く 必要 が あ り ま す 。
AND   password   = ? " ,  entered _user_ name ,  entered _ password ) ▖ first
スパム フィルタ など 、 対象 に よ っ て は ホワイト リスト を 作成 し よう が な い もの も あ り ま す が 、  _ 基本 的 に は まず ホワイト リスト が 使用 さ れ ま す _ 。
この よう な こと に な ら な い よう 、  _ ユーザー の アクセス 権 も クエリ に 含め て くださ い _ 。
###  アカウント に 対 する 総当たり 攻撃
上 に 示 し た よう に 、 配列 の 最初 の 部分 が SQL フラグメント に な っ て お り 、 その 中 に 疑問 符 「 ? 」 が 含 ま れ て い ま す 。
###  クロス サイト スクリプティング   ( XSS )
filename  =   File ▖ expand _ path ( File ▖ join ( basename , @file ▖ public _filename) )
###   よ い パスワード
" ▖▖/▖▖/▖▖/etc/passwd "   の よう な ファイル 名 を 渡 せ ば 、 サーバー の ログ イン 情報 を ダウンロード でき て しま い ま す 。
上 の URL が フィルタ に 引っかか ら な い の は 、 入力 の 2 行 目 に マッチ し て しま う から で す ▟ 従 っ て 、 1 行 目 と 3 行 目 に どんな 文字 列 が あ っ て も フィルタ を 通過 し て しま い ま す 。
INFO : _ CAPTCHA と は 、 コンピュータ に よ る 自動 応答 で な い こと を 確認 する ため の チャレンジ - レスポンス 式 テスト で す 。
Web アプリケーション 用 の ユーザー 名 リスト   ( 名簿 )   は 、 パスワード へ の 総当たり 攻撃 に 悪用 さ れ る 可能 性 が あ り ま す ▟ ユーザー 名 と 同じ で あ る など の 単純 素朴 な パスワード を 使 っ て い る 人 が 驚 く ほど 多 い ため 、 総当たり 攻撃 に 名簿 が 利用 さ れ やす い の で す 。
XSS を 使用 し た 悪意 の あ る 攻撃 が 行 わ れ る と 、 クライアント 側 の コンピュータ に 実行 可能 な コード が 注入 さ れ て しま い ま す 。
これ は 一部 の 言語 で は 正常 に 動作 し ま す 。
条件 オプション に は 文字 列 を 直接 渡 す 代り に 、 以下 の よう に 配列 を 渡 す こと で 、 汚染 さ れ た 文字 列 を サニ タイズ する こと も でき ま す 。
パラメータ は 、 たとえ どれ ほど 難読 化 し 、 隠 そ う と も 変更 さ れ る 可能 性 が あ る こと を 忘れ な い で くださ い 。
データベース 上 の パスワード が 暗号 化 さ れ て い れ ば まだ 最悪 の 事態 は 避け られ ま す 。
アカウント が 有効 に な る と 、 データベース 上 の アクティベーション コード の カラム は NULL に 設定 さ れ ま す 。
これ を 少し で も 緩和 する に は 、  _ 「 パスワード を 忘れ た 場合 」 ページ で も 一般 的 な エラー メッセージ を 表示 する _   よう に し ま しょ う 。
通常 どおり メッセージ を 表示 し て お け ば 、 ボット は 書き込み 失敗 に 気 が 付 か ず に その まま 通り すぎ て い く で しょ う 。
attachment_fu プラグ イン で も 同様 の 手法 が 採用 さ れ て い ま す 。
@project  = @ current_user ▖ projects▖find ( params [ : id ] )
この ルーター を 経由 し て この ネット バンキング サイト に アクセス する と 、 攻撃 者 が 設置 し た 偽 の Web サイト が 開 き 、 信用 情報 が 盗 ま れ て しま い ま し た 。
###  アカウント の ハイジャック
Rails を [ 最低 で も 2 ▖ 1 ▖ 1 に アップデート ] ( http://www ▖rorsecurity▖ info /2008 / 09/ 0 8 /sql- injection - issue - in - limit - and - offset - parameter/) し て くださ い 。
トロイ の 木馬 を わざわざ 特別 に 誂え る と い う の は これ まで も 非常 に まれ な こと で あ り 、 リスク と し て は 相当 低 い と 言え ま す が 、 それ で も ゼロ で は あ り ま せ ん し 、 クライアント ホスト の セキュリティ も 重要 で あ る と い う 好例 で も あ り ま す 。
いわゆる CAPTCHA の 問題 は 、 ユーザー に と っ て 入力 が 多少 な り とも 面倒 に な る こと で す 。
---------------
###  CAPTCHA
  /^https?:\/\/[^\n ] +$/i
イントラネット および 管理 画面 インターフェイス は 、 強 い 権限 が 許 さ れ て い る ため 、 頻繁 に 攻撃 の 目標 に さ れ ま す 。
パスワード を 書き留め たり し な い で くださ い ▟ 覚え られ る 文 を 決め 、 単語 の 頭 文字 を 集め た もの を パスワード に し て くださ い 。
_ Java Script を 使用 し て ユーザー の 入力 データ を 検証 する こと は でき ま す が 、 攻撃 者 が 想定 外 の 値 を 与え て 邪悪 な リクエスト を 送信 する こと は 阻止 でき ま せ ん _ 。
2 つ の ダッシュ 「 -- 」 が 末尾 に 置 か れ る と 、 以後 に 追加 さ れ る クエリ が すべて コメント と 見な さ れ て しま い 、 実行 さ れ な く な り ま す 。
WARNING: _ Rails の ログ 出力 に パスワード が 含 ま れ る こと の な い よう に し て くださ い 。
経験 則 に 照らし合わせ て も 、   _ 安全 が 確認 さ れ て い な い ユーザー 入力 が 安全 で あ る こと は あ り え ず 、 ユーザー から 送信 さ れ る どの よう な パラメータ に も 、 何 ら か の 操作 が 加え られ て い る 可能 性 は 常 に あ り ま す _ 。
Rails   3 ▖ 1 で は 、 同様 の 機能 を 持 つ ビルト イン の ` has_ secure_ password ` メソッド を 使用 でき ま す 。
    link_to   " Homepage " , @user ▖ homepage
この 標的 ユーザー が GMail に ログ イン し て い た 場合 、 フィルタ 設定 が 攻撃 者 に よ っ て 変更 さ れ 、 この 場合 は すべて の メール が 攻撃 者 に 転送 さ れ る よう に な り ま す 。
フィルタ 処理 さ れ て い な い ファイル 名 を 使用 する と 、 ユーザー が 任意 の ファイル を ダウンロード でき る よう に な っ て しま い ま す 。
Firefox の [ Live  HTTP   Headers プラグ イン ] ( http://livehttpheaders▖mozdev▖org/ ) や クライアント 側 で の プロキシ を 使用 する こと で 、 リクエスト を 簡単 に 改ざん する こと が でき ま す 。
この よう な 総当たり 攻撃 を 少し で も かわ す ため 、 多く の Web アプリケーション は わざと 一般 的 な エラー メッセージ 「 ユーザー 名 また は パスワード が 違 い ま す 」 を 表示 する よう に し て い ま す ▟ どちら が 違 っ て い る の か と い う 情報 を 表示 し な い こと で 、 総当たり 攻撃 に よ る 推測 を 少し で も 遅ら せ ま す 。
よ い パスワード の 条件 と は 、 「 十分 に 長 く 」 「 英 文字 と 数字 が 使用 さ れ て お り 」 「 大 文字 と 小 文字 が 両方 使用 さ れ て い る 」 こと で す 。
ここ で は この こと に つ い て 考察 し て み ま しょ う 。
デフォルト で は 、 Rails の ログ に は Web アプリケーション へ の リクエスト が すべて 出力 さ れ ま す 。
この 状態 は 、 アカウント 全体 が ハイジャック さ れ た の と 同じ ぐらい に 有害 で す 。
   validates : content ,   format: {  with : /^ Meanwhile$/, multiline :  true   }
*   ハニー ポット フィールド を 画面 の 外 に 追いや っ て 見え な い よう に する
対応 策 は 、  _ アプリケーション の ロジック を 見なお し て XSS や CSRF 脆弱 性 が 持ち込 ま れ な い よう に する こと _  と しか 言 い よう が あ り ま せ ん 。
XSS   ( クロス サイト スクリプティング )   や SQL インジェクション は インジェクション の 顕著 な 例 で す 。
###  SQL インジェクション
これ に よ っ て 以下 の SQL が 生成 さ れ ま す 。
_ Apache の DocumentRoot が Rails の / public ディレクトリ を 指 し て い る 場合 、 アップロード ファイル を ここ に 置 か な い で くださ い _ ▟ 少な く とも 1 階層 下 に する 必要 が あ り ま す 。
攻撃 者 は メール アドレス 変更 に 成功 する と 、 「 パスワード を 忘れ た 場合 」 ページ に 移動 し 、 攻撃 者 の 新し い メール アドレス に 変更 通知 メール を 送信 し ま す ▟ システム に よ っ て は この メール に 新し い パスワード が 記載 さ れ て い る こと も あ り ま す 。
同時 に 、  _ ユーザー に パスワード を 変更 さ せ る 場合 は 、 古 い パスワード を 必ず 入力 さ せ る よう に し て くださ い ▟ _
以下 は Rails に お け る 典型 的 な データベース クエリ で す ▟ ユーザー が 入力 し た ログ イン 情報 パラメータ と マッチ する User テーブル 上 の 最初 の レコード を 返 し ま す 。
NOTE : _サニタイズ 、 保護 、 検証 で は 、 通常 ホワイト リスト の 方 が ブラック リスト より も 使用 さ れ ま す 。
パスワード や 機密 情報 が ログ ファイル に 平文 の まま で 出力 さ れ て い て は 、 データベース 上 で これ ら の 情報 を 暗号 化 し て い て も 意味 が なくな っ て しま い ま す 。
*   ブラック リスト に 引っかか っ た ユーザー 入力 データ を コード で 修正 し て 使用 し な い で くださ い 。
* * XSS : **   悪意 の あ る ユーザー が イントラネット の 外 から 入力 し た データ が 再 表示 さ れ る と 、 Web アプリケーション が XSS 攻撃 に 対 し て 脆弱 に な り ま す ▟ ユーザー 名 、 コメント 、 スパム レポート 、 注文 フォーム の 住所 の よう な 情報 すら XSS 攻撃 に 使用 さ れ る こと が あ り ま す 。
ネガティブ CAPTCHA と い う 手法 を 使 え ば 、 入力 者 に 自分 が 人間 で あ る こと を 証明 さ せ る かわり に 、 ボット を 罠 に はめ て 正体 を 暴 く こと が でき ま す 。
SELECT  *  FROM   projects   WHERE   name  =  ''  OR   1   - -'
ただし 、 攻撃 者 が データ を 入力 する の は Web サイト 上 の 入力 ボックス と は 限 り ま せ ん ▟ URL に 含 ま れ て い る パラメータ 、 URL に 直接 含 ま れ て い な い が 使用 可能 な 「 隠れ た 」 パラメータ 、 URL に 含 ま れ な い 内部 パラメータ の どこ から で も 攻撃 者 が データ を 入力 する 可能 性 が あ り ま す 。
他 の 場所 で ` sanitize_sql( ) ` を 使 っ て み る こと も でき ま す 。
---------------------------
攻撃 者 が 標的 ユーザー の ユーザー 名 を 知 り 、 その ユーザー が 使用 し て い る パスワード が 弱 けれ ば 、 その アカウント は 簡単 に クラック さ れ て しま い ま す 。
この 結果 、 最初 の ユーザー が データベース に い る こと が わか り 、 結果 が 返 さ れ て ログ イン さ れ ま す 。
http://local host : 300 6 / user/activate
ここ で 、 UNION 文 を 使用 し た 以下 の 文字 列 を 注入 し た と し ま す 。
ここ で 、 ネガティブ CAPTCHA と い う 別 の アイディア が あ り ま す ▟ この 方法 の コンセプト は 、 入力 者 を わずら わせ て 自分 が 人間 で あ る こと を 証明 さ せ る 代り に 、 ボット を 罠 に はめ て 入力 者 が ボット で あ る こと を 突き止め る と い う もの で す 。
管理 画面 は 、 多く の 場合 次 の よう な 作り に な っ て い る もの で す ▟ w w w ▖example ▖ com/admin   の よう な URL に 置 か れ 、 User モデル の admin フラグ が セット さ れ て い る 場合 だけ ここ に アクセス でき 、 管理 者 の 権限 で ユーザー 入力 が 再 表示 さ れ る と 削除 / 追加 / 編集 な ん で も でき て しま い ま す
なお 上 の 記事 に 記載 さ れ て い る の は 概念 実証 に 過ぎ ま せ ん ▟ 仮 に この 攻撃 を 受け た 場合 、 標的 ユーザー は 攻撃 者 が 支配 する Web サイト に 誘い込 ま れ ま す 。
それ に よ り 、 ビュー で recaptcha_tags メソッド を 、 コントローラ で は verify _ recaptcha メソッド を それぞれ 使用 でき ま す 。
辞書 に 載 っ て い る 言葉 に 数字 を 混ぜ た 程度 の パスワード が 使用 さ れ て い る こと が よく あ り ま す 。
*   現在 の UTC タイム スタンプ を 含め た フィールド を フォーム に 含め て お き 、 サーバー 側 で この フィールド を チェック し ま す 。
NOTE : _ 認証   ( authentication )   と 認可   ( authorization )   は ほぼ すべて の Web アプリケーション に お い て 不可欠 で す 。
CSRF に つ い て は 既に 説明 し ま し た の で 、 ここ で は 攻撃 者 が イントラネット や 管理 画面 に 対 し て 攻撃 を 仕掛け る 手順 を いく つ か の 事例 を 示 し て 説明 し ま す 。
INFO : _Ruby の 正規 表現 で 落とし穴 に な り やす い の は 、 より 安全 な 「 \ A 」 や 「 \ z 」 が あ る こと を 知 ら ず に 危険 な 「 \^ 」 や 「 $ 」 を 使 っ て しま う こと で す 。
INFO : _ インジェクション   ( 注入 )   と は 、 Web アプリケーション に 邪悪 な コード や パラメータ を 導入 し て 、 その とき の セキュリティ 権限 で 実行 さ せ る こと で す 。
「 入力 さ れ た ユーザー 名 は 登録 さ れ て い ま せ ん 」 など と い う メッセージ が 返 さ れ よ う もの なら 、 攻撃 者 は すぐさま ユーザー 名 リスト を かき集め て 自動 で 巨大 名簿 を 作成 する で しょ う 。
パスワード が 簡単 に 変更 でき る 画面 設計 ( 古 い パスワード の 入力 が 不要 ) で あ れ ば 、 攻撃 者 は 数 クリック する だけ で アカウント を ハイジャック でき て しま い ま す 。
  #  この 文字 列 の どの 行 で あ っ て も " Meanwhile " と い う 文字 が 含 ま れ て い る 必要 が あ り ま す 。
もちろん 、 この ぐらい で は 自動 化 さ れ た 総当たり 攻撃 プログラム から の 攻撃 から 完全 に 免れ る こと は でき ま せ ん ▟ こう し た プログラム は 送信 元 IP アドレス を 頻繁 に 変更 する ぐらい の こと は や っ て のけ る から で す 。
Web アプリケーション の セキュリティ コンセプト を デザイン する に あた り 、 攻撃 者 が Web サーバー へ の フル アクセス を 成功 さ せ て しま っ た 場合 の こと も 必ず 考慮 に 含め て お く 必要 が あ り ま す 。
Web アプリケーション の 構成 に よ っ て は 、 ユーザー アカウント を ハイジャック する 方法 が 他 に も 潜 ん で い る 可能 性 が あ り ま す 。
他 の 有名 な 事例 と し て は 、 危険 な XSS を 拡散 する ため に 一般 の Web アプリケーション や ブログ 、 掲示 板 が 利用 さ れ た 事件 が あ り ま す 。
この リクエスト に よ っ て DNS 設定 が 変更 さ れ 、 メキシコ で 事業 を 行 っ て い る ネット バンキング Web サイト が 、 攻撃 者 の Web サイト に マップ さ れ て しま い ま し た 。
標的 と な っ た ユーザー が Google   Adsense に ログ イン し 、 Google 広告 キャンペーン 用 の 管理 画面 を 開 く と 、 攻撃 者 が 信用 情報 を 盗み出 す こと が でき て しま い ま し た 。
もちろん 上 は あくまで 例 に 過ぎ ま せ ん ▟ 実際 に は この よう な ありふれ た 文 を パスワード に し な い で くださ い ▟ この 程度 の パスワード は クラッキング 用 辞書 に 収録 さ れ て い る 可能 性 が あ り ま す 。
再び 上 の 例 を 使用 し て 説明 し ま す 。
その 方 が 将来 コントローラ に アクション が 追加 さ れ た 場合 に 、 その アクション を オフ に する の を 忘れ ず に 済 み ま す 。
XSS 対策 の 注入 に 関 する 節 を 参照 し て くださ い 。
basename  =   File ▖ expand _ path ( File ▖ join ( File▖ dirname (__ FILE__) ,  '▖▖
*   クロス サイト スクリプティング   ( XSS )   対策 と し て 、 &lt; script&gt ; を 削除 する の で は な く & lt; strong & gt ; を 許可 し て くださ い 。
この 攻撃 者 は 、 CSRF を 仕込 ん だ 危険 な メール を メキシコ の 多数 の ユーザー に 送信 し ま し た 。
###   正規 表現
あるいは 、 管理 画面 用 に   _ 特別 な ログ イン 情報 _   を 別途 設置 する と い う 方法 も あ り ま す ▟ 一般 ユーザー が 登録 さ れ て い る User モデル に 管理 者 も 登録 し 、 管理 者 フラグ で 分け る と 攻撃 さ れ やす い の で 、 これ を 避け る ため で す 。
_ プラグ イン は 、 機会 を 見 て アップデート する こと を お 勧め し ま す _ 。
改ざん さ れ る 可能 性 が 高 い パラメータ と い え ば id で しょ う ▟` http://www ▖domain▖ com/project/ 1 ` の 1 が id で す 。
こう し た ページ で は よく 、 「 入力 さ れ た ユーザー 名 また は メール アドレス は 登録 さ れ て い ま せ ん 」 と い う 情報 が 表示 さ れ ま す 。
インジェクション は 、 それ に よ っ て 注入 さ れ る コード や パラメータ が 、 ある コンテキスト で は 有害 で あ っ て も 、 それ 以外 の ほとんど の コンテキスト で は 無害 で あ る と い う 点 で 非常 に トリッキー で あ る と 言え ま す 。
User ▖find_ by _ activation_code ( params [ : id ] )
管理 画面 や イントラネット で 1 箇所 で も サニ タイズ 漏れ が あ れ ば 、 アプリケーション 全体 が 脆弱 に な っ て しま い ま す 。
Project ▖ w here ( " name  =  '#{ params [ : name ] }'" )
しかし 、 Web アプリケーション の デザイナー が おろそか に し がち な の は 、 いわゆる 「 パスワード を 忘れ た 場合 」 ページ で す 。
####  不正 な データ 読み出し
エラー メッセージ を より 一般 的 な もの に する こと で 回避 可能 で す が 、 CAPTCHA   ( 相手 が コンピュータ で な い こと を 確認 する ため の テスト )   へ の 情報 入力 の 義務 付け も おそらく 必要 で しょ う _ 。
INFO : _XSS は 最も よく 発生 し する Web セキュリティ 上 の 脆弱 性 で あ り 、 ひとたび 発生 する と 壊滅 的 な 影響 が 生じ る 可能 性 が あ り ま す 。
攻撃 を 困難 に する よう な 改良 が 進 ま な い の は なぜ で しょ う か 。
サニ タイズ さ れ た 変数 は 、 配列 の 後半 に 置 か れ て お り 、 フラグメント 内 の 疑問 符 を 置き換え ま す 。
この よう な 構成 に する こと で 、 通常 の w w w ▖application▖ com   ドメイン から の 管理 者 cookie を 盗み出 す こと が 不 可能 に な り ま す 。
INFO : _ 思い出せ な く な っ た パスワード が あ り ま す か 。
SQL インジェクション は 、 Web アプリケーション の パラメータ を 操作 し て データベース クエリ に 影響 を 与え る こと を 目的 と し た 攻撃 手法 で す 。
User ▖ first ( " login   =  '#{ params [ : name ] }'  AND   password   = '#{ params [ : password ] }'" )
SQL インジェクション は 、 認証 を バイパス する 目的 で よく 使用 さ れ ま す 。
マッチ する 最初 の レコード が この クエリ に よ っ て 取得 さ れ 、 ユーザー に アクセス が 許可 さ れ て しま い ま す 。
これ に 対 する シンプル な 対応 策 は 、  _ リクエスト さ れ た ファイル 名 が 、 期待 さ れ て い る ディレクトリ に あ る か どう か を チェック する _   こと で す 。
特定 の 項目 だけ を 許可 する ホワイト リスト アプローチ は 、 特定 の 項目 だけ を 禁止 する ブラック リスト アプローチ に 比べ て 、 ブラック リスト へ の 禁止 項目 の 追加 忘れ が 原理 的 に 発生 し な い の で 、 望まし い 方法 で あ る と 言え ま す 。
###  ログ 出力
初期 の CAPTCHA で は 背景 を 歪め て 反り を 与え て い ま し た が 、 これ は 突破 さ れ た ため 、 現在 で は 文字 の 上 に 曲線 を 書き加え て 強化 し て い ま す 。
Mozilla  Firefox の Web   Developer   Toolbar を 使用 すれ ば 、 フォーム の 隠し フィールド を 見つけ て 変更 する こと が でき ま す 。
XSS を 使用 する こと で 、 cookie の 盗み出 し 、 セッション の ハイジャック 、 標的 ユーザー を 偽 の Web サイト に 誘い込 む 、 攻撃 者 の 利益 に な る よう な 広告 を 表示 する 、 Web サイト の 要素 を 書き換え て ユーザー 情報 を 盗み出 し たり Web ブラウザ の セキュリティ ・ ホール を 経由 し て 邪悪 な ソフトウェア を インストール し たり でき る こと が あ り ま す 。
多く の Web アプリケーション で は 、 ユーザー アカウント の ハイジャック を 容易 に 行え て しま い ま す 。
いったい どの よう な 問題 が 生じ る の で しょ う か 。
ユーザー が ログ イン 情報 を 入力 する と 、 Web アプリケーション は ユーザー テーブル に 登録 さ れ て い る レコード と マッチ する か どう か を 調べ ま す 。
     File ▖ expand _ path ( File ▖ join ( File▖ dirname ( filename ) ,  '▖▖
*   before_ action で は 、 except: [▖▖▖ ] で は な く only: [▖▖▖ ] を 使用 し て くださ い 。
    SELECT   id , login   AS   name , password   AS   description , 1 , 1 , 1   FROM   users  - -'
さらに 、 Web アプリケーション に この よう な 欠陥 が な い か どう か 見直し を かけ て くださ い 。
    *   その よう な こと を する と 、 " &lt; sc&lt; script&gt;ript&gt; " ▖ gsub (" &lt; script&gt; " , " " ) と い う 攻撃 が 成立 し て しま い ま す 。
しかし 、 パスワード クラック 用 の 辞書 に は こう し た 膨大 な パスワード が 集め られ て お り 、 攻撃 者 は 英 文字 と 数字 の あらゆる 組み合わせ を 試 そ う と し て い ま す 。
WARNING:   _ 1 つ の パラメータ が 変更 さ れ た だけ で も 、 ユーザー が 不正 な 権限 で アクセス でき る よう に な っ て しま う こと が あ り ま す 。
従 っ て 、 名簿 と 辞書 を 使用 し て 総 当り 攻撃 を 行な う 自動 化 プログラム が あ れ ば 、 もの の 数 分 で パスワード は 見破 ら れ て しま い ま す 。
* _ 管理 画面 を 特別 な サブ ドメイン に 置き _ ( admin ▖ application▖ com など ) 、 さらに 独立 し た 管理 アプリケーション に し て ユーザー 管理 を 独自 に 行え る よう に し ま す 。
さらに 、 Java Script に よ る 検証 は Java Script を オフ に すれ 簡単 に バイパス でき て しま い ま す 。
アクティベーション 操作 中 に この こと が 突き止め られ る まで の 流れ は 以下 の とおり で す 。
###  権限 昇格
従 っ て 、 この 場合 以下 の よう な 毒 入り URL は フィルタ を 通過 し て しま い ま す 。
難読 化 と Java Script に よ る 検証 の セキュリティ だけ で 安全 を 保て る と 考え て は な り ま せ ん 。
Rails アプリケーション の 設定 ファイル   config ▖filter_ parameters  に  _ 特定 の リクエスト パラメータ を ログ 出力 時 に フィルタ する _   設定 を 追加 する こと が でき ま す 。
同様 に 、 2 番 目 の クエリ で は AS を 使用 し て カラム 名 を リネーム し て い ま す ▟ これ に よ り 、 ユーザー テーブル から 取り出 し た 値 が Web アプリケーション 上 で 表示 さ れ ま す 。
後 は フォーム の 内容 を 無視 する な り 、 通常 通り メッセージ を 表示 する ( データベース に は 保存 し な い ) など すれ ば よ い の で す 。
@project  =   Project ▖find ( params [ : id ] )
しかし 、  _ Ruby で は 「 \^ 」 と 「 $ 」 は 、 入力 全体 で は な く 、   * * 行の * *   最初 と 最後 _   に マッチ し て しま い ま す 。
ユーザー 管理
インジェクション
javascript : exploit_code ( ) ;/*
Mozilla  Firefox 用 の Live  HTTP   Headers プラグ イン を 使用 する と 、 すべて の リクエスト を ログ に 記録 し て 、 それ ら を 繰り返 し 送信 し たり 変更 し たり する こと が でき ま す 。
ネガティブ CAPTCHA で は 、 ボット を はめ る 罠 と し て 「 ハニー ポット 」 フィールド を 用意 し ま す ▟ これ は 、 CSS や Java Script を 使用 し て 人間 に は 表示 さ れ な い よう に し た ダミー の フィールド で す 。
その サイト の Img タグ に は 仕掛け が あ り 、 GMail の フィルタ 設定 を 変更 する HTTP   GET リクエスト が そこ から 送信 さ れ ま す 。
request ▖ remote_ip メソッド を 使用 し て ユーザー の IP アドレス を チェック でき ま す 。
こう し た 情報 は 、 攻撃 者 が アカウント へ の 総 当り 攻撃 に 使 う 有効 な ユーザー 名 一覧 を 作成 する の に 使 わ れ て しま い ま す 。
2007 年 後半 、 Mozilla ブラウザ で 88 の 脆弱 性 、 Safari で 22 、 IE で 18 、 Opera で 12 の 脆弱 性 が 報告 さ れ ま し た 。
しかし ログ ファイル に は ログ イン 情報 、 クレジット カード 番号 など の 情報 が 含 ま れ て い る こと が あ る ため 、 重大 な セキュリティ 問題 の 原因 に な る こと が あ り ま す 。
その 結果 、 大半 の パスワード が いと も 簡単 に クラック でき て しま う こと が 判明 し ま し た 。
ファイル アップロード 時 に ファイル 名 の フィルタ が 必要 だっ た の と 同様 、 ファイル の ダウンロード 時 に も ファイル 名 を フィルタ する 必要 が あ り ま す 。
その 他 に 、 ファイル 名 を データベース に 保存 し て お き 、 サーバー の ディスク 上 に 置 く 実際 の ファイル 名 に は 代り に データベース の id を 使用 する と い う 方法 も 併用 でき ま す 。
めった に な い と 思 わ れ ま す が 、 「 \ A 」 や 「 \ z 」 の 代り に 「 \^ 」 や 「 $ 」 を どう し て も 使用 し た い 場合 は 、 : multiline オプション を true に 設定 する こと も でき ま す 。
_ 管理 画面 や イントラネット へ の CSRF 攻撃 へ の 対策 に つ い て は 、 CSRF の 対策 に つ い て の 節 を 参照 し て くださ い _ 。
Rails で は 多数 の 認証 用 プラグ イン を 利用 でき ま す 。
認証 システム は 自前 で 作 る より も 、 既存 の プラグ イン   ( 訳注 :   現在 なら gem )   を 使用 する こと を お 勧め し ま す 。
*   ハニー ポット フィールド を 複数 用意 し 、 送信 ボタン を 含 む あらゆる 型 を 与え ま す 。
しかし その よう な パスワード は 覚え にく い の で 、 まず は   _ 覚え られ る 文 を 決め 、 その 文 で 使用 さ れ て い る 単語 の 頭 文字 を 集め て パスワード に する _   こと を お 勧め し ま す 。
攻撃 者 が すべて の トラフィック を 傍受 し て い る 可能 性 を 常 に 考慮 に 入れ る 必要 が あ り ま す 。
なお 、 辞書 に 載 っ て い る 単語 が その まま 使 わ れ て い る ケース は この 中 で 4 % に 過ぎ ず 、 ほとんど は 英 文字 に 数字 を 混ぜ た もの に な っ て い る の は なかなか 興味 深 い 点 で す 。
従 っ て 、  _ ネガティブ CAPTCHA は ログ インフォーム の 保護 に は 必ず しも 向 か な い 可能 性 も あ り ま す _ 。
あるいは 、 パスワード 変更 画面 が CSRF 攻撃 に 対 し て 脆弱 な 作り に な っ て い る 場合 、 攻撃 者 は 標的 ユーザー を 別 の Web ページ に 誘い 込 み 、 CSRF を 実行 する よう に 仕込 ま れ た img タグ を 踏 ま せ て 、 標的 ユーザー の Web パスワード を 変更 する で しょ う 。
イントラネット と Admin の セキュリティ
Ned   Batchelder の [ ブログ 投稿 ] ( http://nedbatchelder ▖ com/ text /stopbots▖html ) に は 、 さらに 洗練 さ れ た ネガティブ CAPTCHA 手法 が いく つ か 紹介 さ れ て い ま す 。
最も あ り がち な 20 の パスワード は 以下 の とおり で す 。
さらに 、 弱視 など 視力 に 問題 の あ る ユーザー は CAPTCHA の 歪 ん だ 画像 を うま く 読め な い こと も あ り ま す 。
最も シンプル な ネガティブ CAPTCHA は 、 ハニー ポット フィールド を 1 つ 使用 する もの で す 。
対応 策 と し て は 、 _ パスワード 変更 フォーム が CSRF 攻撃 に 対 し て 脆弱 に な ら な い よう に する こと _  で す 。
ここ で い う コンテキスト と は 、 スクリプティング 、 クエリ 、 プログラミング 言語 、 シェル 、 Ruby や Rails の メソッド など が あ り ま す 。
しかし ながら 、 攻撃 者 が SQL インジェクション を 使用 する こと で この 認証 を すり抜け て しま う 可能 性 が あ り ま す 。
####   対応 策
攻撃 者 は UNION を 使用 し て データベース から 任意 の データ を 読み出 す 可能 性 が あ り ま す 。
ここ で 攻撃 者 が 「 '  OR   ' 1 ' = ' 1 」 と い う 文字 列 を 名前 フィールド に 入力 し 、 「 '  OR   ' 2 ' > ' 1 」 を パスワード フィールド に 入力 する と 以下 の SQL クエリ が 生成 さ れ ま す 。
攻撃 者 が 、 盗み出 さ れ た ユーザー セッション cookie を 手 に 入れ 、 それ に よ っ て Web アプリケーション が 標的 ユーザー と の 間 で 共用 可能 に な っ た 状態 を 考え て み ま しょ う 。
以下 の よう な URL を リクエスト する ユーザー は 、 データベース で 見つか る 最初 に 有効 に な っ た ユーザー と し て Web サイト に ログ イン でき て しま う こと が あ り ま す ▟ そして それ が たまたま 管理 者 で あ る 可能 性 も あ り ま す 。
対応 策 は 、  _ メール アドレス を 変更 する 場合 に も パスワード 入力 を 必須 に する _   こと で す 。
これ は 、 クエリ で すべて の 条件 が true に な っ て い る ため に 発生 し て い ま す 。
さらに   _ 特定 の IP アドレス から の ログ イン が 一定 回数 以上 失敗 し た 場合 に は 、 CAPTCHA   の 入力 を ユーザー に 義務 付け る _   よう に し て くださ い 。
この 方法 も 、 アップロード ファイル が 実行 さ れ る 可能 性 を 回避 する 方法 と し て 優れ て い ま す 。
クライアント 側 に 、 クライアント から の リクエスト や インターネット から の 応答 を 傍受 し て い る プロキシ が 介在 し て い る 可能 性 も 忘れ な い よう に し て お く 必要 が あ り ま す 。
send _file ( '/var / www/uploads/'  +   params [ :filename ] )
この 他 に いく つ か の 注意 を 守 る こと で 、 アプリケーション を より セキュア に する こと が でき ま す 。
この クエリ で 得 られ る の は プロジェクト の リスト で は な く ( 名前 が 空欄 の プロジェクト は な い の で ) 、 ユーザー 名 と パスワード の リスト で す 。
しかし 攻撃 者 は 、 登録 さ れ て い る メール アドレス を 変更 する こと で アカウント を 乗っ 取 ろ う と する 可能 性 も あ り ま す の で 注意 が 必要 で す 。
_ SQL で 外部 の 文字 列 を 、 サニ タイズ せ ず に 使用 する と セキュリティ 上 重大 な 結果 が もたら さ れ る 可能 性 が あ る こと を 普段 から 考え る 習慣 を つけ ま しょ う _ 。
ネガティブ CAPTCHA は 、 Web を クロール する 自動 ボット から 保護 する こと しか でき ま せ ん ▟ 特定 の サイト に 狙い を 定め て 作 ら れ た ボット まで は 欺け ま せ ん 。
---------
しかし この 対策 は 攻撃 に 対 する ある 程度 の バリア に な る こと も 確か で す 。
フィールド の 時刻 が 遠 い 過去 に な っ て い たり 未来 に な っ て い たり する 場合 は 、 その フォーム は 無効 で す 。
Web アプリケーション に よ っ て は 、 ユーザー が 改ざん 可能 な パラメータ が 他 に も 潜 ん で い る 可能 性 が あ り ま す 。
ここ で は [ GMail の CSRF 脆弱 性 ] ( http://www▖gnucitizen ▖org/ blog / google- gmail - e -mail - hijack -technique/ )   で 紹介 さ れ て い る 例 を とりあげ ま す 。
コントローラ 内 で は 、 次 の よう な こと が 行 わ れ て い る 可能 性 が あ り ま す 。
http://local host : 300 6 / user/activate ? id =
Model ▖ w here ( login : entered _user_ name ,   password :  entered _ password ) ▖ first
新規 ユーザー は 必ず メール 経由 で アクティベーション コード を 受け取 り 、 メール 内 の リンク 先 で アカウント を 有効 に する よう に な っ て い ま す 。
たいてい の ボット は 、 単に Web ページ を クロール し て フォーム を 見つけ る たび に スパム 文 を 入力 する だけ の お 粗末 な もの で す 。
password 1 、 abc123 、 myspace 1 、 password 、 blink 182 、 qwerty 1 、 * * ** you 、 123 abc、 baseball 1 、 football 1 、 1234 5 6 、 soccer 、 monkey 1 、 liverpool 1 、 princess 1 、 jordan 23 、 slipknot 1 、 superman 1 、 iloveyou 1 、 monkey
Ruby   on   Rails に は 、 特殊 な SQL 文字 を フィルタ する 仕組み が ビルト イン で 備わ っ て い ま す ▟ 「 '」 「 " 」 NULL 、 改行 が エスケープ さ れ ま す 。
####   パスワード
ホワイト リスト は これ と 対 を 成 す もの で 、 悪事 に 使 わ れ な い こと が わか っ て い る メール アドレス 、 公式 の アクション 、 無害 な メール アドレス など を ホワイト リスト に する こと が でき ま す 。
なお 、 re CAPTCHA は 古書 の デジタル 化 に も 使え ま す 。
Ruby の 正規 表現 で は 、 文字 列 の 最初 や 最後 に マッチ さ せ る 方法 が 他 の 言語 と 若干 異な り ま す 。
[ Re CAPTCHA ] (https://github▖ com/ambethia/recaptcha/) は Rails の プラグ イン に も な っ て お り 、 API と し て 同じ 名前 が 使用 さ れ て い ま す 。
「 \^ 」 や 「 $ 」 を 使用 し て しま う ミス は 何 か と 発生 し やす い の で 、 正規 表現 が 「 \^ 」 で 始ま っ たり 「 $ 」 で 終わ っ て い たり する と フォーマット バリ データ   ( validates_format _of )   で 例外 が 発生 する よう に な り ま し た 。
UNION 文 は 2 つ の SQL クエリ を つな ぎ 、 1 つ の セット と し て データ を 返 し ま す 。
この id は コントローラ の params を 経由 し て 取得 でき ま す 。
####  メール
フィルタ を すり抜け て しま っ た URL が 、 今度 は ビュー の 以下 の 箇所 で 表示 さ れ た と し ま す 。
Model ▖ w here ( " login   = ?  
攻撃 点 と し て 最も 選 ば れ やす い の は メッセージ 投稿 、 ユーザー コメント 、 ゲスト ブック で す が 、 プロジェクト タイトル 、 ドキュメント 名 、 検索 結果 ページ など も 同様 に 脆弱 性 を 抱え て い た こと が あ り ま し た ▟ ユーザー が データ を 入力 可能 な ところ は どこ で も 攻撃 点 に な り え ま す 。
###  ファイル の ダウンロード
一部 の サーバー で は 、 params [ : id ] で 参照 さ れ る パラメータ id が nil に な っ て しま っ て い る こと が あ る の で 、 上 の URL が 通用 し て しま う 可能 性 が あ り ま す 。
フィルタ さ れ た パラメータ は ログ 内 で   [ FILTERED ]   と い う 文字 に 置き換え られ ま す 。
ここ で は 、 Java Script や CSS を 使用 し て ハニー ポット フィールド を 人間 から 隠 す 方法 を いく つ か 説明 し ま す 。
INFO : _ メソッド の 改良 が 進 ん だ おかげ で 、 SQL インジェクション が Rails アプリケーション で 問題 に な る こと は めった に なくな り ま し た 。
